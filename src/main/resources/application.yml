server:
  port: ${SERVER_PORT:8080}

spring:
  application:
    name: phoebe-service
  
  # R2DBC H2 Database Configuration (default for development)
  r2dbc:
    url: ${R2DBC_URL:r2dbc:h2:mem:///phoebedb;DB_CLOSE_DELAY=-1}
    username: ${R2DBC_USERNAME:sa}
    password: ${R2DBC_PASSWORD:}
  
  # Enable H2 Console (for debugging, disable in production)
  h2:
    console:
      enabled: ${H2_CONSOLE_ENABLED:true}
      path: /h2-console

# DashScope API Configuration
dashscope:
  api:
    base-url: ${DASHSCOPE_BASE_URL:https://dashscope.aliyuncs.com/compatible-mode/v1}
    key: ${DASHSCOPE_API_KEY:sk-dc130f6efb0444b88002fc5a035584ba}
    model: ${DASHSCOPE_MODEL:qwen-flash}
    timeout-seconds: ${DASHSCOPE_TIMEOUT:60}

# Aliyun Bailian Knowledge Base Configuration
bailian:
  # Aliyun credentials (required for Bailian API)
  # Note: AccessKey ID starts with LTAI, Secret is the longer random string
  access-key-id: ${BAILIAN_ACCESS_KEY_ID:LTAI5t9czqToQycaogQdNtFt}
  access-key-secret: ${BAILIAN_ACCESS_KEY_SECRET:cVwoiS1rWrhkejkyCHjvyjJR3DF8vM}
  
  # Bailian workspace and region configuration
  workspace-id: ${BAILIAN_WORKSPACE_ID:llm-zdk5oz26acdjn8mm}
  region: ${BAILIAN_REGION:cn-beijing}
  endpoint: ${BAILIAN_ENDPOINT:bailian.cn-beijing.aliyuncs.com}
  
  # Embedding model for knowledge base
  embedding-model: ${BAILIAN_EMBEDDING_MODEL:text-embedding-v2}
  
  # Retrieval configuration
  retrieve-top-k: ${BAILIAN_RETRIEVE_TOP_K:5}
  retrieve-min-score: ${BAILIAN_RETRIEVE_MIN_SCORE:0.5}
  
  # Sync configuration
  sync-enabled: ${BAILIAN_SYNC_ENABLED:true}
  sync-cron: ${BAILIAN_SYNC_CRON:0 0 2 * * ?}  # Daily at 2 AM
  
  # Default knowledge base index ID (create in Bailian console first)
  # All users will share this index for RAG retrieval
  default-index-id: ${BAILIAN_DEFAULT_INDEX_ID:m71tmd04g9}

# Logging Configuration
logging:
  level:
    root: INFO
    com.phoebe: DEBUG
    org.springframework.r2dbc: DEBUG
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n"
